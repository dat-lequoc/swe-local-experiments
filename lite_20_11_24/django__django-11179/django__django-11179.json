{
  "instance_id": "django__django-11179",
  "model_patch": "diff --git a/django/db/models/deletion.py b/django/db/models/deletion.py\nindex 92fe4affb9..3a462f1c4c 100644\n--- a/django/db/models/deletion.py\n+++ b/django/db/models/deletion.py\n@@ -277,6 +277,7 @@ class Collector:\n             if self.can_fast_delete(instance):\n                 with transaction.mark_for_rollback_on_error():\n                     count = sql.DeleteQuery(model).delete_batch([instance.pk], self.using)\n+                setattr(instance, model._meta.pk.attname, None)\n                 return count, {model._meta.label: count}\n \n         with transaction.atomic(using=self.using, savepoint=False):\ndiff --git a/manage.py b/manage.py\nnew file mode 100644\nindex 0000000000..4fc28347c5\n--- /dev/null\n+++ b/manage.py\n@@ -0,0 +1,8 @@\n+#!/usr/bin/env python\n+import os\n+import sys\n+\n+if __name__ == \"__main__\":\n+    os.environ.setdefault(\"DJANGO_SETTINGS_MODULE\", \"tests.test_settings\")\n+    from django.core.management import execute_from_command_line\n+    execute_from_command_line(sys.argv)\n\\ No newline at end of file\ndiff --git a/runtests.py b/runtests.py\nnew file mode 100644\nindex 0000000000..91632c8c4d\n--- /dev/null\n+++ b/runtests.py\n@@ -0,0 +1,15 @@\n+#!/usr/bin/env python\n+import os\n+import sys\n+\n+import django\n+from django.conf import settings\n+from django.test.utils import get_runner\n+\n+if __name__ == \"__main__\":\n+    os.environ['DJANGO_SETTINGS_MODULE'] = 'tests.test_settings'\n+    django.setup()\n+    TestRunner = get_runner(settings)\n+    test_runner = TestRunner()\n+    failures = test_runner.run_tests([\"tests.delete\"])\n+    sys.exit(bool(failures))\n\\ No newline at end of file\ndiff --git a/tests/delete/test_fast_delete_pk.py b/tests/delete/test_fast_delete_pk.py\nnew file mode 100644\nindex 0000000000..8531e73583\n--- /dev/null\n+++ b/tests/delete/test_fast_delete_pk.py\n@@ -0,0 +1,14 @@\n+from django.test import TestCase\n+from .models import R\n+\n+class FastDeletePKTests(TestCase):\n+    def test_fast_delete_pk_nulling(self):\n+        \"\"\"\n+        Test that the primary key is set to None after deletion,\n+        even when using the fast-delete path.\n+        \"\"\"\n+        r = R.objects.create()\n+        pk = r.pk\n+        r.delete()\n+        self.assertIsNone(r.pk, \"PK should be None after deletion\")\n+        self.assertFalse(R.objects.filter(pk=pk).exists())\n\\ No newline at end of file\ndiff --git a/tests/delete/test_pk_nulling.py b/tests/delete/test_pk_nulling.py\nnew file mode 100644\nindex 0000000000..837e0f0e24\n--- /dev/null\n+++ b/tests/delete/test_pk_nulling.py\n@@ -0,0 +1,14 @@\n+from django.test import TestCase\n+from .models import R\n+\n+class PKNullingTests(TestCase):\n+    def test_pk_nulling_on_fast_delete(self):\n+        \"\"\"\n+        Test that the primary key is set to None after deletion,\n+        even when using the fast-delete path.\n+        \"\"\"\n+        r = R.objects.create()\n+        pk = r.pk\n+        r.delete()\n+        self.assertIsNone(r.pk, \"PK should be None after deletion\")\n+        self.assertFalse(R.objects.filter(pk=pk).exists())\n\\ No newline at end of file\ndiff --git a/tests/delete/test_settings.py b/tests/delete/test_settings.py\nnew file mode 100644\nindex 0000000000..c0cb62cb10\n--- /dev/null\n+++ b/tests/delete/test_settings.py\n@@ -0,0 +1,12 @@\n+DATABASES = {\n+    'default': {\n+        'ENGINE': 'django.db.backends.sqlite3',\n+        'NAME': ':memory:',\n+    }\n+}\n+\n+INSTALLED_APPS = [\n+    'tests.delete',\n+]\n+\n+SECRET_KEY = 'dummy'\n\\ No newline at end of file\ndiff --git a/tests/test_settings.py b/tests/test_settings.py\nnew file mode 100644\nindex 0000000000..f710356f91\n--- /dev/null\n+++ b/tests/test_settings.py\n@@ -0,0 +1,16 @@\n+DATABASES = {\n+    'default': {\n+        'ENGINE': 'django.db.backends.sqlite3',\n+        'NAME': ':memory:',\n+    }\n+}\n+\n+INSTALLED_APPS = [\n+    'django.contrib.contenttypes',\n+    'django.contrib.auth',\n+    'tests.delete',\n+]\n+\n+SECRET_KEY = 'dummy'\n+\n+USE_TZ = False\n\\ No newline at end of file\n",
  "model_name_or_path": "KortixAI"
}