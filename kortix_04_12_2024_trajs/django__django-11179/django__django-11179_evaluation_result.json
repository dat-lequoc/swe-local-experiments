{
  "instance_id": "django__django-11179",
  "test_result": {
    "apply_patch_output": "APPLY_PATCH_PASS\nChecking patch django/db/models/deletion.py...\nApplied patch django/db/models/deletion.py cleanly.\n",
    "test_output": "+ source /opt/miniconda3/bin/activate\n++ _CONDA_ROOT=/opt/miniconda3\n++ . /opt/miniconda3/etc/profile.d/conda.sh\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ '[' -z x ']'\n++ conda activate\n++ local cmd=activate\n++ case \"$cmd\" in\n++ __conda_activate activate\n++ '[' -n '' ']'\n++ local ask_conda\n+++ PS1=\n+++ __conda_exe shell.posix activate\n+++ /opt/miniconda3/bin/conda shell.posix activate\n++ ask_conda='PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''2'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_1='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ eval 'PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''2'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_1='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+++ PS1='(base) '\n+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ export CONDA_PREFIX=/opt/miniconda3\n+++ CONDA_PREFIX=/opt/miniconda3\n+++ export CONDA_SHLVL=2\n+++ CONDA_SHLVL=2\n+++ export CONDA_DEFAULT_ENV=base\n+++ CONDA_DEFAULT_ENV=base\n+++ export 'CONDA_PROMPT_MODIFIER=(base) '\n+++ CONDA_PROMPT_MODIFIER='(base) '\n+++ export CONDA_PREFIX_1=/opt/miniconda3/envs/testbed\n+++ CONDA_PREFIX_1=/opt/miniconda3/envs/testbed\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ __conda_hashr\n++ '[' -n '' ']'\n++ '[' -n '' ']'\n++ hash -r\n+ conda activate testbed\n+ local cmd=activate\n+ case \"$cmd\" in\n+ __conda_activate activate testbed\n+ '[' -n '' ']'\n+ local ask_conda\n++ PS1='(base) '\n++ __conda_exe shell.posix activate testbed\n++ /opt/miniconda3/bin/conda shell.posix activate testbed\n+ ask_conda='PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''3'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_2='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+ eval 'PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''3'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_2='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ PS1='(testbed) '\n++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ export CONDA_SHLVL=3\n++ CONDA_SHLVL=3\n++ export CONDA_DEFAULT_ENV=testbed\n++ CONDA_DEFAULT_ENV=testbed\n++ export 'CONDA_PROMPT_MODIFIER=(testbed) '\n++ CONDA_PROMPT_MODIFIER='(testbed) '\n++ export CONDA_PREFIX_2=/opt/miniconda3\n++ CONDA_PREFIX_2=/opt/miniconda3\n++ export CONDA_EXE=/opt/miniconda3/bin/conda\n++ CONDA_EXE=/opt/miniconda3/bin/conda\n++ export _CE_M=\n++ _CE_M=\n++ export _CE_CONDA=\n++ _CE_CONDA=\n++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+ __conda_hashr\n+ '[' -n '' ']'\n+ '[' -n '' ']'\n+ hash -r\n+ cd /testbed\n+ sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen\n+ locale-gen\n+ export LANG=en_US.UTF-8\n+ LANG=en_US.UTF-8\n+ export LANGUAGE=en_US:en\n+ LANGUAGE=en_US:en\n+ export LC_ALL=en_US.UTF-8\n+ LC_ALL=en_US.UTF-8\n+ git config --global --add safe.directory /testbed\n+ cd /testbed\n+ git status\n+ git show\n+ git diff 19fc6376ce67d01ca37a91ef2f55ef769f50513a\n+ source /opt/miniconda3/bin/activate\n++ _CONDA_ROOT=/opt/miniconda3\n++ . /opt/miniconda3/etc/profile.d/conda.sh\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ '[' -z x ']'\n++ conda activate\n++ local cmd=activate\n++ case \"$cmd\" in\n++ __conda_activate activate\n++ '[' -n '' ']'\n++ local ask_conda\n+++ PS1='(testbed) '\n+++ __conda_exe shell.posix activate\n+++ /opt/miniconda3/bin/conda shell.posix activate\n++ ask_conda='PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''4'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_3='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ eval 'PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''4'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_3='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+++ PS1='(base) '\n+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ export CONDA_PREFIX=/opt/miniconda3\n+++ CONDA_PREFIX=/opt/miniconda3\n+++ export CONDA_SHLVL=4\n+++ CONDA_SHLVL=4\n+++ export CONDA_DEFAULT_ENV=base\n+++ CONDA_DEFAULT_ENV=base\n+++ export 'CONDA_PROMPT_MODIFIER=(base) '\n+++ CONDA_PROMPT_MODIFIER='(base) '\n+++ export CONDA_PREFIX_3=/opt/miniconda3/envs/testbed\n+++ CONDA_PREFIX_3=/opt/miniconda3/envs/testbed\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ __conda_hashr\n++ '[' -n '' ']'\n++ '[' -n '' ']'\n++ hash -r\n+ conda activate testbed\n+ local cmd=activate\n+ case \"$cmd\" in\n+ __conda_activate activate testbed\n+ '[' -n '' ']'\n+ local ask_conda\n++ PS1='(base) '\n++ __conda_exe shell.posix activate testbed\n++ /opt/miniconda3/bin/conda shell.posix activate testbed\n+ ask_conda='PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''5'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_4='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+ eval 'PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''5'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_4='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ PS1='(testbed) '\n++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ export CONDA_SHLVL=5\n++ CONDA_SHLVL=5\n++ export CONDA_DEFAULT_ENV=testbed\n++ CONDA_DEFAULT_ENV=testbed\n++ export 'CONDA_PROMPT_MODIFIER=(testbed) '\n++ CONDA_PROMPT_MODIFIER='(testbed) '\n++ export CONDA_PREFIX_4=/opt/miniconda3\n++ CONDA_PREFIX_4=/opt/miniconda3\n++ export CONDA_EXE=/opt/miniconda3/bin/conda\n++ CONDA_EXE=/opt/miniconda3/bin/conda\n++ export _CE_M=\n++ _CE_M=\n++ export _CE_CONDA=\n++ _CE_CONDA=\n++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+ __conda_hashr\n+ '[' -n '' ']'\n+ '[' -n '' ']'\n+ hash -r\n+ python -m pip install -e .\nWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n+ git checkout 19fc6376ce67d01ca37a91ef2f55ef769f50513a tests/delete/tests.py\nUpdated 0 paths from a40bb59e08\n+ git apply -v -\nChecking patch tests/delete/tests.py...\nApplied patch tests/delete/tests.py cleanly.\n+ ./tests/runtests.py --verbosity 2 --settings=test_sqlite --parallel 1 delete.tests\nCreating test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...\ntest_bulk (delete.tests.DeletionTests) ... ok\ntest_can_defer_constraint_checks (delete.tests.DeletionTests) ... ok\ntest_cannot_defer_constraint_checks (delete.tests.DeletionTests) ... skipped 'Database has feature(s) can_defer_constraint_checks'\ntest_delete_with_keeping_parents (delete.tests.DeletionTests) ... ok\ntest_delete_with_keeping_parents_relationships (delete.tests.DeletionTests) ... ok\ntest_deletion_order (delete.tests.DeletionTests) ... ok\ntest_hidden_related (delete.tests.DeletionTests) ... ok\ntest_instance_update (delete.tests.DeletionTests) ... ok\ntest_large_delete (delete.tests.DeletionTests) ... ok\ntest_large_delete_related (delete.tests.DeletionTests) ... ok\ntest_m2m (delete.tests.DeletionTests) ... ok\ntest_model_delete_returns_num_rows (delete.tests.DeletionTests) ... ok\ntest_proxied_model_duplicate_queries (delete.tests.DeletionTests) ... ok\ntest_queryset_delete_returns_num_rows (delete.tests.DeletionTests) ... ok\ntest_relational_post_delete_signals_happen_before_parent_object (delete.tests.DeletionTests) ... ok\ntest_fast_delete_empty_no_update_can_self_select (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_fk (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_inheritance (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_instance_set_pk_none (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_joined_qs (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_large_batch (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_m2m (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_qs (delete.tests.FastDeleteTests) ... ok\ntest_fast_delete_revm2m (delete.tests.FastDeleteTests) ... ok\ntest_auto (delete.tests.OnDeleteTests) ... ok\ntest_auto_nullable (delete.tests.OnDeleteTests) ... ok\ntest_cascade (delete.tests.OnDeleteTests) ... ok\ntest_cascade_from_child (delete.tests.OnDeleteTests) ... ok\ntest_cascade_from_parent (delete.tests.OnDeleteTests) ... ok\ntest_cascade_nullable (delete.tests.OnDeleteTests) ... ok\ntest_do_nothing (delete.tests.OnDeleteTests) ... ok\ntest_do_nothing_qscount (delete.tests.OnDeleteTests) ... ok\ntest_inheritance_cascade_down (delete.tests.OnDeleteTests) ... ok\ntest_inheritance_cascade_up (delete.tests.OnDeleteTests) ... ok\ntest_o2o_setnull (delete.tests.OnDeleteTests) ... ok\ntest_protect (delete.tests.OnDeleteTests) ... ok\ntest_setdefault (delete.tests.OnDeleteTests) ... ok\ntest_setdefault_none (delete.tests.OnDeleteTests) ... ok\ntest_setnull (delete.tests.OnDeleteTests) ... ok\ntest_setnull_from_child (delete.tests.OnDeleteTests) ... ok\ntest_setnull_from_parent (delete.tests.OnDeleteTests) ... ok\ntest_setvalue (delete.tests.OnDeleteTests) ... ok\n\n----------------------------------------------------------------------\nRan 42 tests in 0.820s\n\nOK (skipped=1)\nDestroying test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...\n+ git checkout 19fc6376ce67d01ca37a91ef2f55ef769f50513a tests/delete/tests.py\nUpdated 1 path from a40bb59e08\nGenerating locales (this might take a while)...\n  en_US.UTF-8... done\nGeneration complete.\nOn branch main\nChanges not staged for commit:\n  (use \"git add <file>...\" to update what will be committed)\n  (use \"git restore <file>...\" to discard changes in working directory)\n\tmodified:   django/db/models/deletion.py\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\ncommit 19fc6376ce67d01ca37a91ef2f55ef769f50513a\nAuthor: Ran Benita <ran234@gmail.com>\nDate:   Mon Apr 1 12:29:10 2019 +0300\n\n    Fixed #30304 -- Added support for the HttpOnly, SameSite, and Secure flags on language cookies.\n\ndiff --git a/django/conf/global_settings.py b/django/conf/global_settings.py\nindex dd368584e5..61d08ddba5 100644\n--- a/django/conf/global_settings.py\n+++ b/django/conf/global_settings.py\n@@ -154,6 +154,9 @@ LANGUAGE_COOKIE_NAME = 'django_language'\n LANGUAGE_COOKIE_AGE = None\n LANGUAGE_COOKIE_DOMAIN = None\n LANGUAGE_COOKIE_PATH = '/'\n+LANGUAGE_COOKIE_SECURE = False\n+LANGUAGE_COOKIE_HTTPONLY = False\n+LANGUAGE_COOKIE_SAMESITE = None\n \n \n # If you set this to True, Django will format dates, numbers and calendars\ndiff --git a/django/views/i18n.py b/django/views/i18n.py\nindex ce5691632c..e3ef40b2fc 100644\n--- a/django/views/i18n.py\n+++ b/django/views/i18n.py\n@@ -55,6 +55,9 @@ def set_language(request):\n                 max_age=settings.LANGUAGE_COOKIE_AGE,\n                 path=settings.LANGUAGE_COOKIE_PATH,\n                 domain=settings.LANGUAGE_COOKIE_DOMAIN,\n+                secure=settings.LANGUAGE_COOKIE_SECURE,\n+                httponly=settings.LANGUAGE_COOKIE_HTTPONLY,\n+                samesite=settings.LANGUAGE_COOKIE_SAMESITE,\n             )\n     return response\n \ndiff --git a/docs/ref/settings.txt b/docs/ref/settings.txt\nindex 5c87aa5d24..ae7436696e 100644\n--- a/docs/ref/settings.txt\n+++ b/docs/ref/settings.txt\n@@ -1766,6 +1766,21 @@ permanently (via the :setting:`LANGUAGE_COOKIE_NAME` setting) and to add\n a middleware that copies the value from the old cookie to a new one and then\n deletes the old one.\n \n+.. setting:: LANGUAGE_COOKIE_HTTPONLY\n+\n+``LANGUAGE_COOKIE_HTTPONLY``\n+----------------------------\n+\n+.. versionadded:: 3.0\n+\n+Default: ``False``\n+\n+Whether to use ``HttpOnly`` flag on the language cookie. If this is set to\n+``True``, client-side JavaScript will not to be able to access the language\n+cookie.\n+\n+See :setting:`SESSION_COOKIE_HTTPONLY` for details on ``HttpOnly``.\n+\n .. setting:: LANGUAGE_COOKIE_NAME\n \n ``LANGUAGE_COOKIE_NAME``\n@@ -1800,6 +1815,33 @@ permanently (via the :setting:`LANGUAGE_COOKIE_NAME` setting), and to add\n a middleware that copies the value from the old cookie to a new one and then\n deletes the one.\n \n+.. setting:: LANGUAGE_COOKIE_SAMESITE\n+\n+``LANGUAGE_COOKIE_SAMESITE``\n+----------------------------\n+\n+.. versionadded:: 3.0\n+\n+Default: ``None``\n+\n+The value of the `SameSite`_ flag on the language cookie. This flag prevents the\n+cookie from being sent in cross-site requests.\n+\n+See :setting:`SESSION_COOKIE_SAMESITE` for details about ``SameSite``.\n+\n+.. setting:: LANGUAGE_COOKIE_SECURE\n+\n+``LANGUAGE_COOKIE_SECURE``\n+--------------------------\n+\n+.. versionadded:: 3.0\n+\n+Default: ``False``\n+\n+Whether to use a secure cookie for the language cookie. If this is set to\n+``True``, the cookie will be marked as \"secure\", which means browsers may\n+ensure that the cookie is only sent under an HTTPS connection.\n+\n .. setting:: LANGUAGES\n \n ``LANGUAGES``\n@@ -3402,8 +3444,11 @@ Globalization (``i18n``/``l10n``)\n * :setting:`LANGUAGE_CODE`\n * :setting:`LANGUAGE_COOKIE_AGE`\n * :setting:`LANGUAGE_COOKIE_DOMAIN`\n+* :setting:`LANGUAGE_COOKIE_HTTPONLY`\n * :setting:`LANGUAGE_COOKIE_NAME`\n * :setting:`LANGUAGE_COOKIE_PATH`\n+* :setting:`LANGUAGE_COOKIE_SAMESITE`\n+* :setting:`LANGUAGE_COOKIE_SECURE`\n * :setting:`LANGUAGES`\n * :setting:`LANGUAGES_BIDI`\n * :setting:`LOCALE_PATHS`\ndiff --git a/docs/releases/3.0.txt b/docs/releases/3.0.txt\nindex 11257b70be..d7ad7a8cf7 100644\n--- a/docs/releases/3.0.txt\n+++ b/docs/releases/3.0.txt\n@@ -153,7 +153,11 @@ Generic Views\n Internationalization\n ~~~~~~~~~~~~~~~~~~~~\n \n-* ...\n+* Added the :setting:`LANGUAGE_COOKIE_HTTPONLY`,\n+  :setting:`LANGUAGE_COOKIE_SAMESITE`, and :setting:`LANGUAGE_COOKIE_SECURE`\n+  settings to set the ``HttpOnly``, ``SameSite``, and ``Secure`` flags on\n+  language cookies. The default values of these settings preserve the previous\n+  behavior.\n \n Management Commands\n ~~~~~~~~~~~~~~~~~~~\ndiff --git a/docs/topics/i18n/translation.txt b/docs/topics/i18n/translation.txt\nindex 00338100f9..bafa4bdaf1 100644\n--- a/docs/topics/i18n/translation.txt\n+++ b/docs/topics/i18n/translation.txt\n@@ -1896,7 +1896,10 @@ A number of settings can be used to adjust language cookie options:\n * :setting:`LANGUAGE_COOKIE_NAME`\n * :setting:`LANGUAGE_COOKIE_AGE`\n * :setting:`LANGUAGE_COOKIE_DOMAIN`\n+* :setting:`LANGUAGE_COOKIE_HTTPONLY`\n * :setting:`LANGUAGE_COOKIE_PATH`\n+* :setting:`LANGUAGE_COOKIE_SAMESITE`\n+* :setting:`LANGUAGE_COOKIE_SECURE`\n \n Implementation notes\n ====================\ndiff --git a/tests/view_tests/tests/test_i18n.py b/tests/view_tests/tests/test_i18n.py\nindex 7b36181800..1362bc2911 100644\n--- a/tests/view_tests/tests/test_i18n.py\n+++ b/tests/view_tests/tests/test_i18n.py\n@@ -45,6 +45,9 @@ class SetLanguageTests(TestCase):\n         self.assertEqual(language_cookie['domain'], '')\n         self.assertEqual(language_cookie['path'], '/')\n         self.assertEqual(language_cookie['max-age'], '')\n+        self.assertEqual(language_cookie['httponly'], '')\n+        self.assertEqual(language_cookie['samesite'], '')\n+        self.assertEqual(language_cookie['secure'], '')\n \n     def test_setlang_unsafe_next(self):\n         \"\"\"\n@@ -175,6 +178,9 @@ class SetLanguageTests(TestCase):\n             'LANGUAGE_COOKIE_AGE': 3600 * 7 * 2,\n             'LANGUAGE_COOKIE_DOMAIN': '.example.com',\n             'LANGUAGE_COOKIE_PATH': '/test/',\n+            'LANGUAGE_COOKIE_HTTPONLY': True,\n+            'LANGUAGE_COOKIE_SAMESITE': 'Strict',\n+            'LANGUAGE_COOKIE_SECURE': True,\n         }\n         with self.settings(**test_settings):\n             post_data = {'language': 'pl', 'next': '/views/'}\n@@ -184,6 +190,9 @@ class SetLanguageTests(TestCase):\n             self.assertEqual(language_cookie['domain'], '.example.com')\n             self.assertEqual(language_cookie['path'], '/test/')\n             self.assertEqual(language_cookie['max-age'], 3600 * 7 * 2)\n+            self.assertEqual(language_cookie['httponly'], True)\n+            self.assertEqual(language_cookie['samesite'], 'Strict')\n+            self.assertEqual(language_cookie['secure'], True)\n \n     def test_setlang_decodes_http_referer_url(self):\n         \"\"\"\ndiff --git a/django/db/models/deletion.py b/django/db/models/deletion.py\nindex 92fe4affb9..0bd756bdd8 100644\n--- a/django/db/models/deletion.py\n+++ b/django/db/models/deletion.py\n@@ -277,6 +277,7 @@ class Collector:\n             if self.can_fast_delete(instance):\n                 with transaction.mark_for_rollback_on_error():\n                     count = sql.DeleteQuery(model).delete_batch([instance.pk], self.using)\n+                setattr(instance, model._meta.pk.attname, None)\n                 return count, {model._meta.label: count}\n \n         with transaction.atomic(using=self.using, savepoint=False):\n@@ -324,4 +325,4 @@ class Collector:\n         for model, instances in self.data.items():\n             for instance in instances:\n                 setattr(instance, model._meta.pk.attname, None)\n-        return sum(deleted_counter.values()), dict(deleted_counter)\n+        return sum(deleted_counter.values()), dict(deleted_counter)\n\\ No newline at end of file\nObtaining file:///testbed\nRequirement already satisfied: pytz in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.0.dev20190408092606) (2024.1)\nRequirement already satisfied: sqlparse in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.0.dev20190408092606) (0.4.4)\nInstalling collected packages: Django\n  Attempting uninstall: Django\n    Found existing installation: Django 3.0.dev20190408092606\n    Uninstalling Django-3.0.dev20190408092606:\n      Successfully uninstalled Django-3.0.dev20190408092606\n  Running setup.py develop for Django\nSuccessfully installed Django-3.0.dev20190408092606\nTesting against Django installed in '/testbed/django'\nImporting application delete\nSkipping setup of unused database(s): other.\nOperations to perform:\n  Synchronize unmigrated apps: auth, contenttypes, delete, messages, sessions, staticfiles\n  Apply all migrations: admin, sites\nSynchronizing apps without migrations:\n  Creating tables...\n    Creating table django_content_type\n    Creating table auth_permission\n    Creating table auth_group\n    Creating table auth_user\n    Creating table django_session\n    Creating table delete_r\n    Creating table delete_s\n    Creating table delete_t\n    Creating table delete_u\n    Creating table delete_rchild\n    Creating table delete_a\n    Creating table delete_m\n    Creating table delete_mr\n    Creating table delete_mrnull\n    Creating table delete_avatar\n    Creating table delete_user\n    Creating table delete_hiddenuser\n    Creating table delete_hiddenuserprofile\n    Creating table delete_m2mto\n    Creating table delete_m2mfrom\n    Creating table delete_parent\n    Creating table delete_child\n    Creating table delete_base\n    Creating table delete_reltobase\n    Running deferred SQL...\nRunning migrations:\n  Applying admin.0001_initial... OK\n  Applying admin.0002_logentry_remove_auto_add... OK\n  Applying admin.0003_logentry_add_action_flag_choices... OK\n  Applying sites.0001_initial... OK\n  Applying sites.0002_alter_domain_unique... OK\nSystem check identified no issues (0 silenced).\n",
    "report": {
      "patch_is_None": false,
      "patch_exists": true,
      "patch_successfully_applied": true,
      "resolved": true,
      "tests_status": {
        "FAIL_TO_PASS": {
          "success": [
            "test_fast_delete_instance_set_pk_none (delete.tests.FastDeleteTests)"
          ],
          "failure": []
        },
        "PASS_TO_PASS": {
          "success": [
            "test_fast_delete_empty_no_update_can_self_select (delete.tests.FastDeleteTests)",
            "test_fast_delete_fk (delete.tests.FastDeleteTests)",
            "test_fast_delete_inheritance (delete.tests.FastDeleteTests)",
            "test_fast_delete_joined_qs (delete.tests.FastDeleteTests)",
            "test_fast_delete_large_batch (delete.tests.FastDeleteTests)",
            "test_fast_delete_m2m (delete.tests.FastDeleteTests)",
            "test_fast_delete_qs (delete.tests.FastDeleteTests)",
            "test_fast_delete_revm2m (delete.tests.FastDeleteTests)",
            "test_auto (delete.tests.OnDeleteTests)",
            "test_auto_nullable (delete.tests.OnDeleteTests)",
            "test_cascade (delete.tests.OnDeleteTests)",
            "test_cascade_from_child (delete.tests.OnDeleteTests)",
            "test_cascade_from_parent (delete.tests.OnDeleteTests)",
            "test_cascade_nullable (delete.tests.OnDeleteTests)",
            "test_do_nothing (delete.tests.OnDeleteTests)",
            "test_do_nothing_qscount (delete.tests.OnDeleteTests)",
            "test_inheritance_cascade_down (delete.tests.OnDeleteTests)",
            "test_inheritance_cascade_up (delete.tests.OnDeleteTests)",
            "test_o2o_setnull (delete.tests.OnDeleteTests)",
            "test_protect (delete.tests.OnDeleteTests)",
            "test_setdefault (delete.tests.OnDeleteTests)",
            "test_setdefault_none (delete.tests.OnDeleteTests)",
            "test_setnull (delete.tests.OnDeleteTests)",
            "test_setnull_from_child (delete.tests.OnDeleteTests)",
            "test_setnull_from_parent (delete.tests.OnDeleteTests)",
            "test_setvalue (delete.tests.OnDeleteTests)",
            "test_bulk (delete.tests.DeletionTests)",
            "test_can_defer_constraint_checks (delete.tests.DeletionTests)",
            "test_delete_with_keeping_parents (delete.tests.DeletionTests)",
            "test_delete_with_keeping_parents_relationships (delete.tests.DeletionTests)",
            "test_deletion_order (delete.tests.DeletionTests)",
            "test_hidden_related (delete.tests.DeletionTests)",
            "test_instance_update (delete.tests.DeletionTests)",
            "test_large_delete (delete.tests.DeletionTests)",
            "test_large_delete_related (delete.tests.DeletionTests)",
            "test_m2m (delete.tests.DeletionTests)",
            "test_model_delete_returns_num_rows (delete.tests.DeletionTests)",
            "test_proxied_model_duplicate_queries (delete.tests.DeletionTests)",
            "test_queryset_delete_returns_num_rows (delete.tests.DeletionTests)",
            "test_relational_post_delete_signals_happen_before_parent_object (delete.tests.DeletionTests)"
          ],
          "failure": []
        },
        "FAIL_TO_FAIL": {
          "success": [],
          "failure": []
        },
        "PASS_TO_FAIL": {
          "success": [],
          "failure": []
        }
      }
    }
  }
}