{
  "instance_id": "django__django-16041",
  "model_patch": "diff --git a/django/forms/formsets.py b/django/forms/formsets.py\nindex 57676428ff..59b68845b9 100644\n--- a/django/forms/formsets.py\n+++ b/django/forms/formsets.py\n@@ -257,12 +257,14 @@ class BaseFormSet(RenderableFormMixin):\n \n     @property\n     def empty_form(self):\n+        form_kwargs = self.get_form_kwargs(None)\n+        form_kwargs.pop('empty_permitted', None)  # Remove if exists\n         form = self.form(\n             auto_id=self.auto_id,\n             prefix=self.add_prefix(\"__prefix__\"),\n             empty_permitted=True,\n             use_required_attribute=False,\n-            **self.get_form_kwargs(None),\n+            **form_kwargs,\n             renderer=self.renderer,\n         )\n         self.add_fields(form, None)\n@@ -573,4 +575,4 @@ def formset_factory(\n def all_valid(formsets):\n     \"\"\"Validate every formset and return True if all are valid.\"\"\"\n     # List comprehension ensures is_valid() is called for all formsets.\n-    return all([formset.is_valid() for formset in formsets])\n+    return all([formset.is_valid() for formset in formsets])\n\\ No newline at end of file\ndiff --git a/tests/forms_tests/tests/test_formsets.py b/tests/forms_tests/tests/test_formsets.py\nindex c36a79d4e0..0dbf099b73 100644\n--- a/tests/forms_tests/tests/test_formsets.py\n+++ b/tests/forms_tests/tests/test_formsets.py\n@@ -179,6 +179,14 @@ class FormsFormsetTestCase(SimpleTestCase):\n         self.assertTrue(hasattr(formset.empty_form, \"custom_kwarg\"))\n         self.assertEqual(formset.empty_form.custom_kwarg, 1)\n \n+    def test_empty_form_with_empty_permitted_in_form_kwargs(self):\n+        \"\"\"empty_form should work when empty_permitted is in form_kwargs.\"\"\"\n+        FormSet = formset_factory(Choice)\n+        formset = FormSet(form_kwargs={\"empty_permitted\": False})\n+        self.assertTrue(formset.empty_form.empty_permitted)\n+        formset = FormSet(form_kwargs={\"empty_permitted\": True})\n+        self.assertTrue(formset.empty_form.empty_permitted)\n+\n     def test_formset_validation(self):\n         # FormSet instances can also have an error attribute if validation failed for\n         # any of the forms.\n@@ -1920,4 +1928,4 @@ class DeprecationTests(SimpleTestCase):\n         ):\n             ChoiceFormSet = formset_factory(Choice, formset=BaseFormSet)\n             formset = ChoiceFormSet()\n-            str(formset.management_form)\n+            str(formset.management_form)\n\\ No newline at end of file\n",
  "model_name_or_path": "KortixAI"
}