{
  "instance_id": "django__django-11019",
  "test_result": {
    "apply_patch_output": "APPLY_PATCH_PASS\n/tmp/patch.diff:33: trailing whitespace.\n        \n/tmp/patch.diff:36: trailing whitespace.\n        \n/tmp/patch.diff:39: trailing whitespace.\n        \n/tmp/patch.diff:49: trailing whitespace.\n                        \n/tmp/patch.diff:58: trailing whitespace.\n                                    'Detected circular Media file dependencies:\\n%s and %s' % \nChecking patch django/forms/widgets.py...\nChecking patch tests/forms_tests/tests/test_media.py...\nApplied patch django/forms/widgets.py cleanly.\nApplied patch tests/forms_tests/tests/test_media.py cleanly.\nwarning: squelched 4 whitespace errors\nwarning: 9 lines add whitespace errors.\n",
    "test_output": "+ source /opt/miniconda3/bin/activate\n++ _CONDA_ROOT=/opt/miniconda3\n++ . /opt/miniconda3/etc/profile.d/conda.sh\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ '[' -z x ']'\n++ conda activate\n++ local cmd=activate\n++ case \"$cmd\" in\n++ __conda_activate activate\n++ '[' -n '' ']'\n++ local ask_conda\n+++ PS1=\n+++ __conda_exe shell.posix activate\n+++ /opt/miniconda3/bin/conda shell.posix activate\n++ ask_conda='PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''2'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_1='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ eval 'PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''2'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_1='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+++ PS1='(base) '\n+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ export CONDA_PREFIX=/opt/miniconda3\n+++ CONDA_PREFIX=/opt/miniconda3\n+++ export CONDA_SHLVL=2\n+++ CONDA_SHLVL=2\n+++ export CONDA_DEFAULT_ENV=base\n+++ CONDA_DEFAULT_ENV=base\n+++ export 'CONDA_PROMPT_MODIFIER=(base) '\n+++ CONDA_PROMPT_MODIFIER='(base) '\n+++ export CONDA_PREFIX_1=/opt/miniconda3/envs/testbed\n+++ CONDA_PREFIX_1=/opt/miniconda3/envs/testbed\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ __conda_hashr\n++ '[' -n '' ']'\n++ '[' -n '' ']'\n++ hash -r\n+ conda activate testbed\n+ local cmd=activate\n+ case \"$cmd\" in\n+ __conda_activate activate testbed\n+ '[' -n '' ']'\n+ local ask_conda\n++ PS1='(base) '\n++ __conda_exe shell.posix activate testbed\n++ /opt/miniconda3/bin/conda shell.posix activate testbed\n+ ask_conda='PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''3'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_2='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+ eval 'PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''3'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_2='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ PS1='(testbed) '\n++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ export CONDA_SHLVL=3\n++ CONDA_SHLVL=3\n++ export CONDA_DEFAULT_ENV=testbed\n++ CONDA_DEFAULT_ENV=testbed\n++ export 'CONDA_PROMPT_MODIFIER=(testbed) '\n++ CONDA_PROMPT_MODIFIER='(testbed) '\n++ export CONDA_PREFIX_2=/opt/miniconda3\n++ CONDA_PREFIX_2=/opt/miniconda3\n++ export CONDA_EXE=/opt/miniconda3/bin/conda\n++ CONDA_EXE=/opt/miniconda3/bin/conda\n++ export _CE_M=\n++ _CE_M=\n++ export _CE_CONDA=\n++ _CE_CONDA=\n++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+ __conda_hashr\n+ '[' -n '' ']'\n+ '[' -n '' ']'\n+ hash -r\n+ cd /testbed\n+ sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen\n+ locale-gen\n+ export LANG=en_US.UTF-8\n+ LANG=en_US.UTF-8\n+ export LANGUAGE=en_US:en\n+ LANGUAGE=en_US:en\n+ export LC_ALL=en_US.UTF-8\n+ LC_ALL=en_US.UTF-8\n+ git config --global --add safe.directory /testbed\n+ cd /testbed\n+ git status\n+ git show\n+ git diff 93e892bb645b16ebaf287beb5fe7f3ffe8d10408\n+ source /opt/miniconda3/bin/activate\n++ _CONDA_ROOT=/opt/miniconda3\n++ . /opt/miniconda3/etc/profile.d/conda.sh\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ '[' -z x ']'\n++ conda activate\n++ local cmd=activate\n++ case \"$cmd\" in\n++ __conda_activate activate\n++ '[' -n '' ']'\n++ local ask_conda\n+++ PS1='(testbed) '\n+++ __conda_exe shell.posix activate\n+++ /opt/miniconda3/bin/conda shell.posix activate\n++ ask_conda='PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''4'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_3='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ eval 'PS1='\\''(base) '\\''\nexport PATH='\\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3'\\''\nexport CONDA_SHLVL='\\''4'\\''\nexport CONDA_DEFAULT_ENV='\\''base'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(base) '\\''\nexport CONDA_PREFIX_3='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+++ PS1='(base) '\n+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+++ export CONDA_PREFIX=/opt/miniconda3\n+++ CONDA_PREFIX=/opt/miniconda3\n+++ export CONDA_SHLVL=4\n+++ CONDA_SHLVL=4\n+++ export CONDA_DEFAULT_ENV=base\n+++ CONDA_DEFAULT_ENV=base\n+++ export 'CONDA_PROMPT_MODIFIER=(base) '\n+++ CONDA_PROMPT_MODIFIER='(base) '\n+++ export CONDA_PREFIX_3=/opt/miniconda3/envs/testbed\n+++ CONDA_PREFIX_3=/opt/miniconda3/envs/testbed\n+++ export CONDA_EXE=/opt/miniconda3/bin/conda\n+++ CONDA_EXE=/opt/miniconda3/bin/conda\n+++ export _CE_M=\n+++ _CE_M=\n+++ export _CE_CONDA=\n+++ _CE_CONDA=\n+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ __conda_hashr\n++ '[' -n '' ']'\n++ '[' -n '' ']'\n++ hash -r\n+ conda activate testbed\n+ local cmd=activate\n+ case \"$cmd\" in\n+ __conda_activate activate testbed\n+ '[' -n '' ']'\n+ local ask_conda\n++ PS1='(base) '\n++ __conda_exe shell.posix activate testbed\n++ /opt/miniconda3/bin/conda shell.posix activate testbed\n+ ask_conda='PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''5'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_4='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n+ eval 'PS1='\\''(testbed) '\\''\nexport PATH='\\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\\''\nexport CONDA_PREFIX='\\''/opt/miniconda3/envs/testbed'\\''\nexport CONDA_SHLVL='\\''5'\\''\nexport CONDA_DEFAULT_ENV='\\''testbed'\\''\nexport CONDA_PROMPT_MODIFIER='\\''(testbed) '\\''\nexport CONDA_PREFIX_4='\\''/opt/miniconda3'\\''\nexport CONDA_EXE='\\''/opt/miniconda3/bin/conda'\\''\nexport _CE_M='\\'''\\''\nexport _CE_CONDA='\\'''\\''\nexport CONDA_PYTHON_EXE='\\''/opt/miniconda3/bin/python'\\'''\n++ PS1='(testbed) '\n++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ CONDA_PREFIX=/opt/miniconda3/envs/testbed\n++ export CONDA_SHLVL=5\n++ CONDA_SHLVL=5\n++ export CONDA_DEFAULT_ENV=testbed\n++ CONDA_DEFAULT_ENV=testbed\n++ export 'CONDA_PROMPT_MODIFIER=(testbed) '\n++ CONDA_PROMPT_MODIFIER='(testbed) '\n++ export CONDA_PREFIX_4=/opt/miniconda3\n++ CONDA_PREFIX_4=/opt/miniconda3\n++ export CONDA_EXE=/opt/miniconda3/bin/conda\n++ CONDA_EXE=/opt/miniconda3/bin/conda\n++ export _CE_M=\n++ _CE_M=\n++ export _CE_CONDA=\n++ _CE_CONDA=\n++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python\n+ __conda_hashr\n+ '[' -n '' ']'\n+ '[' -n '' ']'\n+ hash -r\n+ python -m pip install -e .\nWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n+ git checkout 93e892bb645b16ebaf287beb5fe7f3ffe8d10408 tests/admin_inlines/tests.py tests/admin_widgets/test_autocomplete_widget.py tests/forms_tests/tests/test_media.py\nUpdated 1 path from f50e576e6b\n+ git apply -v -\nChecking patch tests/admin_inlines/tests.py...\nChecking patch tests/admin_widgets/test_autocomplete_widget.py...\nChecking patch tests/forms_tests/tests/test_media.py...\nApplied patch tests/admin_inlines/tests.py cleanly.\nApplied patch tests/admin_widgets/test_autocomplete_widget.py cleanly.\nApplied patch tests/forms_tests/tests/test_media.py cleanly.\n+ ./tests/runtests.py --verbosity 2 --settings=test_sqlite --parallel 1 admin_inlines.tests admin_widgets.test_autocomplete_widget forms_tests.tests.test_media\nCreating test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...\ntest_callable_lookup (admin_inlines.tests.TestInline)\nAdmin inline should invoke local callable when its name is listed in readonly_fields ... ok\ntest_can_delete (admin_inlines.tests.TestInline) ... ok\ntest_create_inlines_on_inherited_model (admin_inlines.tests.TestInline) ... ok\ntest_custom_form_tabular_inline_label (admin_inlines.tests.TestInline) ... ok\ntest_custom_form_tabular_inline_overridden_label (admin_inlines.tests.TestInline) ... ok\ntest_custom_get_extra_form (admin_inlines.tests.TestInline) ... ok\ntest_custom_min_num (admin_inlines.tests.TestInline) ... ok\ntest_custom_pk_shortcut (admin_inlines.tests.TestInline) ... ok\ntest_help_text (admin_inlines.tests.TestInline) ... ok\ntest_inline_editable_pk (admin_inlines.tests.TestInline) ... ok\ntest_inline_hidden_field_no_column (admin_inlines.tests.TestInline)\n#18263 -- Make sure hidden fields don't get a column in tabular inlines ... ok\ntest_inline_nonauto_noneditable_inherited_pk (admin_inlines.tests.TestInline) ... ok\ntest_inline_nonauto_noneditable_pk (admin_inlines.tests.TestInline) ... ok\ntest_inline_primary (admin_inlines.tests.TestInline) ... ok\ntest_inlines_show_change_link_registered (admin_inlines.tests.TestInline)\nInlines `show_change_link` for registered models when enabled. ... ok\ntest_inlines_show_change_link_unregistered (admin_inlines.tests.TestInline)\nInlines `show_change_link` disabled for unregistered models. ... ok\ntest_localize_pk_shortcut (admin_inlines.tests.TestInline) ... ok\ntest_many_to_many_inlines (admin_inlines.tests.TestInline)\nAutogenerated many-to-many inlines are displayed correctly (#13407) ... ok\ntest_min_num (admin_inlines.tests.TestInline) ... ok\ntest_no_parent_callable_lookup (admin_inlines.tests.TestInline)\nAdmin inline `readonly_field` shouldn't invoke parent ModelAdmin callable ... ok\ntest_non_related_name_inline (admin_inlines.tests.TestInline) ... ok\ntest_noneditable_inline_has_field_inputs (admin_inlines.tests.TestInline)\nInlines without change permission shows field inputs on add form. ... ok\ntest_readonly_stacked_inline_label (admin_inlines.tests.TestInline)\nBug #13174. ... ok\ntest_stacked_inline_edit_form_contains_has_original_class (admin_inlines.tests.TestInline) ... ok\ntest_tabular_inline_column_css_class (admin_inlines.tests.TestInline) ... ok\ntest_tabular_inline_show_change_link_false_registered (admin_inlines.tests.TestInline)\nInlines `show_change_link` disabled by default. ... ok\ntest_tabular_model_form_meta_readonly_field (admin_inlines.tests.TestInline) ... ok\ntest_tabular_non_field_errors (admin_inlines.tests.TestInline) ... ok\ntest_immutable_content_type (admin_inlines.tests.TestInlineAdminForm)\nRegression for #9362 ... ok\ntest_all_inline_media (admin_inlines.tests.TestInlineMedia) ... ok\ntest_inline_media_only_base (admin_inlines.tests.TestInlineMedia) ... ok\ntest_inline_media_only_inline (admin_inlines.tests.TestInlineMedia) ... FAIL\ntest_inline_add_fk_add_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_add_fk_noperm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_add_m2m_add_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_add_m2m_noperm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_fk_add_change_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_fk_add_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_fk_all_perms (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_fk_change_del_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_fk_change_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_fk_noperm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_m2m_add_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_m2m_change_perm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_inline_change_m2m_noperm (admin_inlines.tests.TestInlinePermissions) ... ok\ntest_deleting_inline_with_protected_delete_does_not_validate (admin_inlines.tests.TestInlineProtectedOnDelete) ... ok\ntest_build_attrs (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) ... ok\ntest_build_attrs_no_custom_class (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) ... ok\ntest_build_attrs_not_required_field (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) ... ok\ntest_build_attrs_required_field (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) ... ok\ntest_get_url (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) ... ok\ntest_media (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) ... test_render_options (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) ... ok\ntest_render_options_not_required_field (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)\nEmpty option isn't present if the field isn't required. ... ok\ntest_render_options_required_field (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)\nEmpty option is present if the field isn't required. ... ok\ntest_add_inlines (admin_inlines.tests.SeleniumTests) ... skipped 'No browsers specified.'\ntest_add_stackeds (admin_inlines.tests.SeleniumTests) ... skipped 'No browsers specified.'\ntest_alternating_rows (admin_inlines.tests.SeleniumTests) ... skipped 'No browsers specified.'\ntest_collapsed_inlines (admin_inlines.tests.SeleniumTests) ... skipped 'No browsers specified.'\ntest_delete_inlines (admin_inlines.tests.SeleniumTests) ... skipped 'No browsers specified.'\ntest_delete_stackeds (admin_inlines.tests.SeleniumTests) ... skipped 'No browsers specified.'\ntest_combine_media (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_construction (forms_tests.tests.test_media.FormsMediaTestCase) ... FAIL\ntest_form_media (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_html_safe (forms_tests.tests.test_media.FormsMediaTestCase) ... ok\ntest_media_deduplication (forms_tests.tests.test_media.FormsMediaTestCase) ... FAIL\ntest_media_dsl (forms_tests.tests.test_media.FormsMediaTestCase) ... ok\ntest_media_inheritance (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_media_inheritance_extends (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_media_inheritance_from_property (forms_tests.tests.test_media.FormsMediaTestCase) ... ok\ntest_media_inheritance_single_type (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_media_property (forms_tests.tests.test_media.FormsMediaTestCase) ... ok\ntest_media_property_parent_references (forms_tests.tests.test_media.FormsMediaTestCase) ... FAIL\ntest_merge (forms_tests.tests.test_media.FormsMediaTestCase) ... test_merge_css_three_way (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_merge_js_three_way (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_merge_js_three_way2 (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\ntest_merge_warning (forms_tests.tests.test_media.FormsMediaTestCase) ... FAIL\ntest_multi_media (forms_tests.tests.test_media.FormsMediaTestCase) ... ok\ntest_multi_widget (forms_tests.tests.test_media.FormsMediaTestCase) ... ERROR\n\n======================================================================\nERROR: test_combine_media (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 122, in test_combine_media\n    str(w1.media + w2.media + w3.media),\n  File \"/testbed/django/utils/html.py\", line 388, in <lambda>\n    klass.__str__ = lambda self: mark_safe(klass_str(self))\n  File \"/testbed/django/forms/widgets.py\", line 58, in __str__\n    return self.render()\n  File \"/testbed/django/forms/widgets.py\", line 80, in render\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 80, in <genexpr>\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 93, in render_css\n    media = sorted(self._css)\n  File \"/testbed/django/forms/widgets.py\", line 67, in _css\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 67, in <dictcomp>\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_form_media (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 470, in test_form_media\n    str(f1.media),\n  File \"/testbed/django/utils/html.py\", line 388, in <lambda>\n    klass.__str__ = lambda self: mark_safe(klass_str(self))\n  File \"/testbed/django/forms/widgets.py\", line 58, in __str__\n    return self.render()\n  File \"/testbed/django/forms/widgets.py\", line 80, in render\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 80, in <genexpr>\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 87, in render_js\n    ) for path in self._js\n  File \"/testbed/django/forms/widgets.py\", line 76, in _js\n    js = self.merge(js, obj)\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_media_inheritance (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 255, in test_media_inheritance\n    str(w8.media),\n  File \"/testbed/django/utils/html.py\", line 388, in <lambda>\n    klass.__str__ = lambda self: mark_safe(klass_str(self))\n  File \"/testbed/django/forms/widgets.py\", line 58, in __str__\n    return self.render()\n  File \"/testbed/django/forms/widgets.py\", line 80, in render\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 80, in <genexpr>\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 93, in render_css\n    media = sorted(self._css)\n  File \"/testbed/django/forms/widgets.py\", line 67, in _css\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 67, in <dictcomp>\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_media_inheritance_extends (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 330, in test_media_inheritance_extends\n    str(w11.media),\n  File \"/testbed/django/utils/html.py\", line 388, in <lambda>\n    klass.__str__ = lambda self: mark_safe(klass_str(self))\n  File \"/testbed/django/forms/widgets.py\", line 58, in __str__\n    return self.render()\n  File \"/testbed/django/forms/widgets.py\", line 80, in render\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 80, in <genexpr>\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 93, in render_css\n    media = sorted(self._css)\n  File \"/testbed/django/forms/widgets.py\", line 67, in _css\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 67, in <dictcomp>\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_media_inheritance_single_type (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 359, in test_media_inheritance_single_type\n    str(w12.media),\n  File \"/testbed/django/utils/html.py\", line 388, in <lambda>\n    klass.__str__ = lambda self: mark_safe(klass_str(self))\n  File \"/testbed/django/forms/widgets.py\", line 58, in __str__\n    return self.render()\n  File \"/testbed/django/forms/widgets.py\", line 80, in render\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 80, in <genexpr>\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 93, in render_css\n    media = sorted(self._css)\n  File \"/testbed/django/forms/widgets.py\", line 67, in _css\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 67, in <dictcomp>\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=([2, 3], [1, 2]))\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=([1, 3], [2, 3]))\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\n  File \"/testbed/django/forms/widgets.py\", line 156, in merge\n    MediaOrderConflictWarning,\ndjango.forms.widgets.MediaOrderConflictWarning: Detected circular Media file dependencies:\n2 and 3\n\n======================================================================\nERROR: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=([1, 2], [1, 3]))\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=([1, 2], [3, 2]))\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\n  File \"/testbed/django/forms/widgets.py\", line 156, in merge\n    MediaOrderConflictWarning,\ndjango.forms.widgets.MediaOrderConflictWarning: Detected circular Media file dependencies:\n2 and 3\n\n======================================================================\nERROR: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=[[1, 2], [1, 3], [2, 3], [5, 7], [5, 6], [6, 7, 9], [8, 9]])\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\nTypeError: merge() takes 2 positional arguments but 7 were given\n\n======================================================================\nERROR: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=())\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\nTypeError: merge() missing 2 required positional arguments: 'list_1' and 'list_2'\n\n======================================================================\nERROR: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=([1, 2],))\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\nTypeError: merge() missing 1 required positional argument: 'list_2'\n\n======================================================================\nERROR: test_merge_css_three_way (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 590, in test_merge_css_three_way\n    self.assertEqual(merged._css, {'screen': ['a.css', 'b.css', 'c.css'], 'all': ['d.css', 'e.css']})\n  File \"/testbed/django/forms/widgets.py\", line 67, in _css\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 67, in <dictcomp>\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 156, in merge\n    MediaOrderConflictWarning,\ndjango.forms.widgets.MediaOrderConflictWarning: Detected circular Media file dependencies:\na.css and c.css\n\n======================================================================\nERROR: test_merge_js_three_way (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 568, in test_merge_js_three_way\n    self.assertEqual(merged._js, ['text-editor.js', 'text-editor-extras.js', 'color-picker.js'])\n  File \"/testbed/django/forms/widgets.py\", line 76, in _js\n    js = self.merge(js, obj)\n  File \"/testbed/django/forms/widgets.py\", line 156, in merge\n    MediaOrderConflictWarning,\ndjango.forms.widgets.MediaOrderConflictWarning: Detected circular Media file dependencies:\ncolor-picker.js and text-editor.js\n\n======================================================================\nERROR: test_merge_js_three_way2 (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 578, in test_merge_js_three_way2\n    self.assertEqual(merged._js, ['a', 'b', 'c', 'f', 'g', 'h', 'k'])\n  File \"/testbed/django/forms/widgets.py\", line 76, in _js\n    js = self.merge(js, obj)\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nERROR: test_multi_widget (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 428, in test_multi_widget\n    str(mymulti.media),\n  File \"/testbed/django/utils/html.py\", line 388, in <lambda>\n    klass.__str__ = lambda self: mark_safe(klass_str(self))\n  File \"/testbed/django/forms/widgets.py\", line 58, in __str__\n    return self.render()\n  File \"/testbed/django/forms/widgets.py\", line 80, in render\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 80, in <genexpr>\n    return mark_safe('\\n'.join(chain.from_iterable(getattr(self, 'render_' + name)() for name in MEDIA_TYPES)))\n  File \"/testbed/django/forms/widgets.py\", line 93, in render_css\n    media = sorted(self._css)\n  File \"/testbed/django/forms/widgets.py\", line 67, in _css\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 67, in <dictcomp>\n    for medium in css.keys() | obj.keys()\n  File \"/testbed/django/forms/widgets.py\", line 159, in merge\n    if existing_idx > path_idx:\nUnboundLocalError: local variable 'existing_idx' referenced before assignment\n\n======================================================================\nFAIL: test_inline_media_only_inline (admin_inlines.tests.TestInlineMedia)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/admin_inlines/tests.py\", line 503, in test_inline_media_only_inline\n    'admin/js/inlines.min.js',\nAssertionError: Lists differ: ['adm[32 chars]s', 'admin/js/jquery.init.js', 'admin/js/inlin[58 chars].js'] != ['adm[32 chars]s', 'my_awesome_inline_scripts.js', 'custom_nu[58 chars].js']\n\nFirst differing element 1:\n'admin/js/jquery.init.js'\n'my_awesome_inline_scripts.js'\n\n  ['admin/js/vendor/jquery/jquery.min.js',\n+  'my_awesome_inline_scripts.js',\n+  'custom_number.js',\n   'admin/js/jquery.init.js',\n-  'admin/js/inlines.min.js',\n?                           ^\n\n+  'admin/js/inlines.min.js']\n?                           ^\n\n-  'my_awesome_inline_scripts.js',\n-  'custom_number.js']\n\n======================================================================\nFAIL: test_media (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) (lang='de')\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/admin_widgets/test_autocomplete_widget.py\", line 142, in test_media\n    self.assertEqual(AutocompleteSelect(rel, admin.site).media._js, list(expected_files))\nAssertionError: ('admin/js/vendor/jquery/jquery.min.js', [134 chars].js') != ['admin/js/vendor/jquery/jquery.min.js', [134 chars].js']\n\n======================================================================\nFAIL: test_media (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) (lang='00')\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/admin_widgets/test_autocomplete_widget.py\", line 142, in test_media\n    self.assertEqual(AutocompleteSelect(rel, admin.site).media._js, list(expected_files))\nAssertionError: ('admin/js/vendor/jquery/jquery.min.js', [96 chars].js') != ['admin/js/vendor/jquery/jquery.min.js', [96 chars].js']\n\n======================================================================\nFAIL: test_media (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) (lang='sr-cyrl')\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/admin_widgets/test_autocomplete_widget.py\", line 142, in test_media\n    self.assertEqual(AutocompleteSelect(rel, admin.site).media._js, list(expected_files))\nAssertionError: ('admin/js/vendor/jquery/jquery.min.js', [139 chars].js') != ['admin/js/vendor/jquery/jquery.min.js', [139 chars].js']\n\n======================================================================\nFAIL: test_media (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) (lang='zh-hans')\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/admin_widgets/test_autocomplete_widget.py\", line 142, in test_media\n    self.assertEqual(AutocompleteSelect(rel, admin.site).media._js, list(expected_files))\nAssertionError: ('admin/js/vendor/jquery/jquery.min.js', [137 chars].js') != ['admin/js/vendor/jquery/jquery.min.js', [137 chars].js']\n\n======================================================================\nFAIL: test_media (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests) (lang='zh-hant')\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/admin_widgets/test_autocomplete_widget.py\", line 142, in test_media\n    self.assertEqual(AutocompleteSelect(rel, admin.site).media._js, list(expected_files))\nAssertionError: ('admin/js/vendor/jquery/jquery.min.js', [137 chars].js') != ['admin/js/vendor/jquery/jquery.min.js', [137 chars].js']\n\n======================================================================\nFAIL: test_construction (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 28, in test_construction\n    \"Media(css={'all': ['path/to/css1', '/path/to/css2']}, \"\nAssertionError: \"Media(css={'all': ('path/to/css1', '/path/to/css2')}, js=('[89 chars]3'))\" != \"Media(css={'all': ['path/to/css1', '/path/to/css2']}, js=['[89 chars]3'])\"\n- Media(css={'all': ('path/to/css1', '/path/to/css2')}, js=('/path/to/js1', 'http://media.other.com/path/to/js2', 'https://secure.other.com/path/to/js3'))\n?                   ^                               ^      ^                                                                                            ^\n+ Media(css={'all': ['path/to/css1', '/path/to/css2']}, js=['/path/to/js1', 'http://media.other.com/path/to/js2', 'https://secure.other.com/path/to/js3'])\n?                   ^                               ^      ^                                                                                            ^\n\n\n======================================================================\nFAIL: test_media_deduplication (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 163, in test_media_deduplication\n    <script type=\"text/javascript\" src=\"/path/to/js1\"></script>\"\"\")\nAssertionError: '<lin[66 chars]\">\\n<link href=\"/path/to/css1\" type=\"text/css\"[148 chars]ipt>' != '<lin[66 chars]\">\\n<script type=\"text/javascript\" src=\"/path/[13 chars]ipt>'\n\n======================================================================\nFAIL: test_media_property_parent_references (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 216, in test_media_property_parent_references\n    <script type=\"text/javascript\" src=\"https://secure.other.com/path/to/js3\"></script>\"\"\"\nAssertionError: '<lin[109 chars]ef=\"/path/to/css2\" type=\"text/css\" media=\"all\"[373 chars]ipt>' != '<lin[109 chars]ef=\"/other/path\" type=\"text/css\" media=\"all\" r[373 chars]ipt>'\n\n======================================================================\nFAIL: test_merge (forms_tests.tests.test_media.FormsMediaTestCase) (lists=([1, 2], [3, 4]))\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 553, in test_merge\n    self.assertEqual(Media.merge(*lists), expected)\nAssertionError: Lists differ: [1, 2, 3, 4] != [1, 3, 2, 4]\n\nFirst differing element 1:\n2\n3\n\n- [1, 2, 3, 4]\n?        ---\n\n+ [1, 3, 2, 4]\n?     +++\n\n\n======================================================================\nFAIL: test_merge_warning (forms_tests.tests.test_media.FormsMediaTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/testbed/tests/forms_tests/tests/test_media.py\", line 558, in test_merge_warning\n    self.assertEqual(Media.merge([1, 2], [2, 1]), [1, 2])\n  File \"/opt/miniconda3/envs/testbed/lib/python3.6/contextlib.py\", line 88, in __exit__\n    next(self.gen)\n  File \"/testbed/django/test/testcases.py\", line 676, in _assert_raises_or_warns_cm\n    self.assertIn(expected_message, str(getattr(cm, cm_attr)))\nAssertionError: 'Detected duplicate Media files in an opposite order: [1, 2], [2, 1]' not found in 'Detected circular Media file dependencies:\\n1 and 2'\n\n----------------------------------------------------------------------\nRan 80 tests in 2.020s\n\nFAILED (failures=11, errors=16, skipped=6)\nDestroying test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...\n+ git checkout 93e892bb645b16ebaf287beb5fe7f3ffe8d10408 tests/admin_inlines/tests.py tests/admin_widgets/test_autocomplete_widget.py tests/forms_tests/tests/test_media.py\nUpdated 3 paths from f50e576e6b\nGenerating locales (this might take a while)...\n  en_US.UTF-8... done\nGeneration complete.\nOn branch main\nChanges not staged for commit:\n  (use \"git add <file>...\" to update what will be committed)\n  (use \"git restore <file>...\" to discard changes in working directory)\n\tmodified:   django/forms/widgets.py\n\tmodified:   tests/forms_tests/tests/test_media.py\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\ncommit 93e892bb645b16ebaf287beb5fe7f3ffe8d10408\nAuthor: Tim Graham <timograham@gmail.com>\nDate:   Wed Feb 27 16:17:10 2019 -0500\n\n    Refs #29523 -- Updated admin's collapse.min.js.\n    \n    Omitted in ba83378a7762c51be235b521aa5b48233d6c6c82.\n\ndiff --git a/django/contrib/admin/static/admin/js/collapse.min.js b/django/contrib/admin/static/admin/js/collapse.min.js\nindex 6e1a06de16..6f59280e5a 100644\n--- a/django/contrib/admin/static/admin/js/collapse.min.js\n+++ b/django/contrib/admin/static/admin/js/collapse.min.js\n@@ -1,5 +1,2 @@\n-var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||\"function\"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};\n-$jscomp.getGlobal=function(a){return\"undefined\"!=typeof window&&window===a?a:\"undefined\"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(\".\");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};\n-$jscomp.polyfill(\"Array.prototype.find\",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},\"es6\",\"es3\");\n-(function(a){a(document).ready(function(){a(\"fieldset.collapse\").each(function(c,b){0===a(b).find(\"div.errors\").length&&a(b).addClass(\"collapsed\").find(\"h2\").first().append(' (<a id=\"fieldsetcollapser'+c+'\" class=\"collapse-toggle\" href=\"#\">'+gettext(\"Show\")+\"</a>)\")});a(\"fieldset.collapse a.collapse-toggle\").on(\"click\",function(c){a(this).closest(\"fieldset\").hasClass(\"collapsed\")?a(this).text(gettext(\"Hide\")).closest(\"fieldset\").removeClass(\"collapsed\").trigger(\"show.fieldset\",[a(this).attr(\"id\")]):\n-a(this).text(gettext(\"Show\")).closest(\"fieldset\").addClass(\"collapsed\").trigger(\"hide.fieldset\",[a(this).attr(\"id\")]);return!1})})})(django.jQuery);\n+(function(){var e=function(a,b){return a.nodeName===b.toUpperCase()?a:\"BODY\"===a.parentNode.nodeName?null:a.parentNode&&e(a.parentNode,b)};window.addEventListener(\"load\",function(){for(var a=document.querySelectorAll(\"fieldset.collapse\"),b=0;b<a.length;b++){var c=a[b];if(0===c.querySelectorAll(\"div.errors\").length){c.classList.add(\"collapsed\");c=c.querySelector(\"h2\");var d=document.createElement(\"a\");d.setAttribute(\"id\",\"fieldsetcollapser\"+b);d.setAttribute(\"class\",\"collapse-toggle\");d.setAttribute(\"href\",\n+\"#\");d.textContent=gettext(\"Show\");c.appendChild(document.createTextNode(\" (\"));c.appendChild(d);c.appendChild(document.createTextNode(\")\"))}}a=document.querySelectorAll(\"fieldset.collapse a.collapse-toggle\");c=function(a){a.preventDefault();a=e(this,\"fieldset\");a.classList.contains(\"collapsed\")?(this.textContent=gettext(\"Hide\"),a.classList.remove(\"collapsed\")):(this.textContent=gettext(\"Show\"),a.classList.add(\"collapsed\"))};for(b=0;b<a.length;b++)a[b].addEventListener(\"click\",c)})})();\ndiff --git a/django/forms/widgets.py b/django/forms/widgets.py\nindex 02aa32b207..22b995e44e 100644\n--- a/django/forms/widgets.py\n+++ b/django/forms/widgets.py\n@@ -117,37 +117,52 @@ class Media:\n     @staticmethod\n     def merge(list_1, list_2):\n         \"\"\"\n-        Merge two lists while trying to keep the relative order of the elements.\n-        Warn if the lists have the same two elements in a different relative\n-        order.\n+        Merge lists while trying to keep the relative order of the elements.\n+        Warn if there's a genuine circular dependency between files.\n \n         For static assets it can be important to have them included in the DOM\n         in a certain order. In JavaScript you may not be able to reference a\n         global or in CSS you might want to override a style.\n         \"\"\"\n-        # Start with a copy of list_1.\n-        combined_list = list(list_1)\n-        last_insert_index = len(list_1)\n-        # Walk list_2 in reverse, inserting each element into combined_list if\n-        # it doesn't already exist.\n-        for path in reversed(list_2):\n-            try:\n-                # Does path already exist in the list?\n-                index = combined_list.index(path)\n-            except ValueError:\n-                # Add path to combined_list since it doesn't exist.\n-                combined_list.insert(last_insert_index, path)\n+        combined = list(list_1)\n+        positions = {path: i for i, path in enumerate(combined)}\n+        \n+        # Track seen conflicts to avoid duplicate warnings\n+        seen_conflicts = set()\n+        \n+        # Track dependencies to avoid false positives\n+        dependencies = {}\n+        \n+        for path in list_2:\n+            if path in positions:\n+                current_pos = positions[path]\n+                # Check for actual circular dependencies\n+                for i, existing in enumerate(combined[current_pos + 1:], start=current_pos + 1):\n+                    if existing in list_2:\n+                        # Get positions in list_2\n+                        path_idx = list_2.index(path)\n+                        existing_idx = list_2.index(existing)\n+                        \n+                        # Only warn if this creates a genuine circular dependency\n+                        if existing_idx < path_idx:\n+                            # Ensure consistent warning message order\n+                            first, second = sorted([existing, path])\n+                            conflict_key = (first, second)\n+                            if conflict_key not in seen_conflicts:\n+                                seen_conflicts.add(conflict_key)\n+                                warnings.warn(\n+                                    'Detected circular Media file dependencies:\\n%s and %s' % \n+                                    (first, second),\n+                                    MediaOrderConflictWarning,\n+                                )\n+                    # Track dependency\n+                    if existing_idx > path_idx:\n+                        dependencies.setdefault(path, []).append(existing)\n             else:\n-                if index > last_insert_index:\n-                    warnings.warn(\n-                        'Detected duplicate Media files in an opposite order:\\n'\n-                        '%s\\n%s' % (combined_list[last_insert_index], combined_list[index]),\n-                        MediaOrderConflictWarning,\n-                    )\n-                # path already exists in the list. Update last_insert_index so\n-                # that the following elements are inserted in front of this one.\n-                last_insert_index = index\n-        return combined_list\n+                combined.append(path)\n+                positions[path] = len(combined) - 1\n+                \n+        return combined\n \n     def __add__(self, other):\n         combined = Media()\n@@ -1080,4 +1095,4 @@ class SelectDateWidget(Widget):\n         return not any(\n             ('{}_{}'.format(name, interval) in data)\n             for interval in ('year', 'month', 'day')\n-        )\n+        )\n\\ No newline at end of file\ndiff --git a/tests/forms_tests/tests/test_media.py b/tests/forms_tests/tests/test_media.py\nindex 8cb484a15e..c82e2e1cfc 100644\n--- a/tests/forms_tests/tests/test_media.py\n+++ b/tests/forms_tests/tests/test_media.py\n@@ -538,9 +538,27 @@ class FormsMediaTestCase(SimpleTestCase):\n                 self.assertEqual(Media.merge(list1, list2), expected)\n \n     def test_merge_warning(self):\n-        msg = 'Detected duplicate Media files in an opposite order:\\n1\\n2'\n+        msg = 'Detected circular Media file dependencies:\\n1 and 2'\n         with self.assertWarnsMessage(RuntimeWarning, msg):\n             self.assertEqual(Media.merge([1, 2], [2, 1]), [1, 2])\n+            \n+    def test_merge_with_dependencies(self):\n+        \"\"\"Test merging media with dependencies is handled correctly.\"\"\"\n+        # text-editor-extras.js depends on text-editor.js\n+        list1 = ['color-picker.js']\n+        list2 = ['text-editor.js']\n+        list3 = ['text-editor.js', 'text-editor-extras.js', 'color-picker.js']\n+        \n+        # Merge first two lists\n+        merged = Media.merge(list1, list2)\n+        # Merge with third list\n+        final = Media.merge(merged, list3)\n+        \n+        # Verify correct ordering\n+        self.assertEqual(\n+            final,\n+            ['text-editor.js', 'text-editor-extras.js', 'color-picker.js']\n+        )\n \n     def test_merge_js_three_way(self):\n         \"\"\"\n@@ -570,4 +588,4 @@ class FormsMediaTestCase(SimpleTestCase):\n         # ...but merging succeeds as the relative ordering of a.css and b.css\n         # was never specified.\n         merged = widget3 + form1 + form2\n-        self.assertEqual(merged._css, {'screen': ['a.css', 'b.css'], 'all': ['c.css']})\n+        self.assertEqual(merged._css, {'screen': ['a.css', 'b.css'], 'all': ['c.css']})\n\\ No newline at end of file\nObtaining file:///testbed\nRequirement already satisfied: pytz in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.0.dev20190227211710) (2024.1)\nRequirement already satisfied: sqlparse in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.0.dev20190227211710) (0.4.4)\nInstalling collected packages: Django\n  Attempting uninstall: Django\n    Found existing installation: Django 3.0.dev20190227211710\n    Uninstalling Django-3.0.dev20190227211710:\n      Successfully uninstalled Django-3.0.dev20190227211710\n  Running setup.py develop for Django\nSuccessfully installed Django-3.0.dev20190227211710\nTesting against Django installed in '/testbed/django'\nImporting application admin_inlines\nImporting application admin_widgets\nImporting application forms_tests\nSkipping setup of unused database(s): other.\nOperations to perform:\n  Synchronize unmigrated apps: admin_inlines, admin_widgets, auth, contenttypes, forms_tests, messages, sessions, staticfiles\n  Apply all migrations: admin, sites\nSynchronizing apps without migrations:\n  Creating tables...\n    Creating table django_content_type\n    Creating table auth_permission\n    Creating table auth_group\n    Creating table auth_user\n    Creating table django_session\n    Creating table admin_inlines_parent\n    Creating table admin_inlines_teacher\n    Creating table admin_inlines_child\n    Creating table admin_inlines_book\n    Creating table admin_inlines_author\n    Creating table admin_inlines_nonautopkbook\n    Creating table admin_inlines_nonautopkbookchild\n    Creating table admin_inlines_editablepkbook\n    Creating table admin_inlines_holder\n    Creating table admin_inlines_inner\n    Creating table admin_inlines_holder2\n    Creating table admin_inlines_inner2\n    Creating table admin_inlines_holder3\n    Creating table admin_inlines_inner3\n    Creating table admin_inlines_holder4\n    Creating table admin_inlines_inner4stacked\n    Creating table admin_inlines_inner4tabular\n    Creating table admin_inlines_person\n    Creating table admin_inlines_outfititem\n    Creating table admin_inlines_fashionista\n    Creating table admin_inlines_shoppingweakness\n    Creating table admin_inlines_titlecollection\n    Creating table admin_inlines_title\n    Creating table admin_inlines_poll\n    Creating table admin_inlines_question\n    Creating table admin_inlines_novel\n    Creating table admin_inlines_chapter\n    Creating table admin_inlines_footnote\n    Creating table admin_inlines_capofamiglia\n    Creating table admin_inlines_consigliere\n    Creating table admin_inlines_sottocapo\n    Creating table admin_inlines_readonlyinline\n    Creating table admin_inlines_parentmodelwithcustompk\n    Creating table admin_inlines_childmodel1\n    Creating table admin_inlines_childmodel2\n    Creating table admin_inlines_binarytree\n    Creating table admin_inlines_lifeform\n    Creating table admin_inlines_extraterrestrial\n    Creating table admin_inlines_sighting\n    Creating table admin_inlines_someparentmodel\n    Creating table admin_inlines_somechildmodel\n    Creating table admin_inlines_profilecollection\n    Creating table admin_inlines_profile\n    Creating table admin_widgets_member\n    Creating table admin_widgets_band\n    Creating table admin_widgets_album\n    Creating table admin_widgets_inventory\n    Creating table admin_widgets_event\n    Creating table admin_widgets_car\n    Creating table admin_widgets_cartire\n    Creating table admin_widgets_honeycomb\n    Creating table admin_widgets_bee\n    Creating table admin_widgets_individual\n    Creating table admin_widgets_company\n    Creating table admin_widgets_advisor\n    Creating table admin_widgets_student\n    Creating table admin_widgets_school\n    Creating table admin_widgets_profile\n    Creating table forms_tests_boundarymodel\n    Creating table forms_tests_defaults\n    Creating table forms_tests_choicemodel\n    Creating table forms_tests_choiceoptionmodel\n    Creating table forms_tests_choicefieldmodel\n    Creating table forms_tests_optionalmultichoicemodel\n    Creating table forms_tests_filemodel\n    Creating table forms_tests_article\n    Running deferred SQL...\nRunning migrations:\n  Applying admin.0001_initial... OK\n  Applying admin.0002_logentry_remove_auto_add... OK\n  Applying admin.0003_logentry_add_action_flag_choices... OK\n  Applying sites.0001_initial... OK\n  Applying sites.0002_alter_domain_unique... OK\nSystem check identified no issues (0 silenced).\n",
    "report": {
      "patch_is_None": false,
      "patch_exists": true,
      "patch_successfully_applied": true,
      "resolved": false,
      "tests_status": {
        "FAIL_TO_PASS": {
          "success": [],
          "failure": [
            "test_combine_media (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_construction (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_form_media (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media_deduplication (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media_inheritance (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media_inheritance_extends (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media_property_parent_references (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_merge (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_merge_css_three_way (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_merge_js_three_way (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_merge_js_three_way2 (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_merge_warning (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_multi_widget (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)",
            "test_render_options (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)",
            "test_inline_media_only_inline (admin_inlines.tests.TestInlineMedia)"
          ]
        },
        "PASS_TO_PASS": {
          "success": [
            "Regression for #9362",
            "test_html_safe (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media_dsl (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media_inheritance_from_property (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_media_property (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_multi_media (forms_tests.tests.test_media.FormsMediaTestCase)",
            "test_build_attrs (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)",
            "test_build_attrs_no_custom_class (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)",
            "test_build_attrs_not_required_field (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)",
            "test_build_attrs_required_field (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)",
            "test_get_url (admin_widgets.test_autocomplete_widget.AutocompleteMixinTests)",
            "Empty option isn't present if the field isn't required.",
            "Empty option is present if the field isn't required.",
            "test_deleting_inline_with_protected_delete_does_not_validate (admin_inlines.tests.TestInlineProtectedOnDelete)",
            "test_all_inline_media (admin_inlines.tests.TestInlineMedia)",
            "test_inline_media_only_base (admin_inlines.tests.TestInlineMedia)",
            "test_inline_add_fk_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_add_fk_noperm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_add_m2m_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_add_m2m_noperm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_add_change_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_all_perms (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_change_del_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_change_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_fk_noperm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_m2m_add_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_m2m_change_perm (admin_inlines.tests.TestInlinePermissions)",
            "test_inline_change_m2m_noperm (admin_inlines.tests.TestInlinePermissions)",
            "Admin inline should invoke local callable when its name is listed in readonly_fields",
            "test_can_delete (admin_inlines.tests.TestInline)",
            "test_create_inlines_on_inherited_model (admin_inlines.tests.TestInline)",
            "test_custom_form_tabular_inline_label (admin_inlines.tests.TestInline)",
            "test_custom_form_tabular_inline_overridden_label (admin_inlines.tests.TestInline)",
            "test_custom_get_extra_form (admin_inlines.tests.TestInline)",
            "test_custom_min_num (admin_inlines.tests.TestInline)",
            "test_custom_pk_shortcut (admin_inlines.tests.TestInline)",
            "test_help_text (admin_inlines.tests.TestInline)",
            "test_inline_editable_pk (admin_inlines.tests.TestInline)",
            "#18263 -- Make sure hidden fields don't get a column in tabular inlines",
            "test_inline_nonauto_noneditable_inherited_pk (admin_inlines.tests.TestInline)",
            "test_inline_nonauto_noneditable_pk (admin_inlines.tests.TestInline)",
            "test_inline_primary (admin_inlines.tests.TestInline)",
            "Inlines `show_change_link` for registered models when enabled.",
            "Inlines `show_change_link` disabled for unregistered models.",
            "test_localize_pk_shortcut (admin_inlines.tests.TestInline)",
            "Autogenerated many-to-many inlines are displayed correctly (#13407)",
            "test_min_num (admin_inlines.tests.TestInline)",
            "Admin inline `readonly_field` shouldn't invoke parent ModelAdmin callable",
            "test_non_related_name_inline (admin_inlines.tests.TestInline)",
            "Inlines without change permission shows field inputs on add form.",
            "Bug #13174.",
            "test_stacked_inline_edit_form_contains_has_original_class (admin_inlines.tests.TestInline)",
            "test_tabular_inline_column_css_class (admin_inlines.tests.TestInline)",
            "Inlines `show_change_link` disabled by default.",
            "test_tabular_model_form_meta_readonly_field (admin_inlines.tests.TestInline)",
            "test_tabular_non_field_errors (admin_inlines.tests.TestInline)"
          ],
          "failure": [
            "test_media_inheritance_single_type (forms_tests.tests.test_media.FormsMediaTestCase)"
          ]
        },
        "FAIL_TO_FAIL": {
          "success": [],
          "failure": []
        },
        "PASS_TO_FAIL": {
          "success": [],
          "failure": []
        }
      }
    }
  }
}